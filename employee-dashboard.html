<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Employee Dashboard — SnapEats</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/css/styles.css" rel="stylesheet">
</head>
<body>
  <nav class="navbar navbar-expand-lg px-4">
    <a class="navbar-brand" href="index.html">SnapEats</a>
    <div class="ms-auto">
      <a class="btn btn-outline-primary btn-sm" href="login.html">Sign out</a>
    </div>
  </nav>

  <main class="container py-4">
    <h3 class="section-title">Employee — Orders Dashboard</h3>
    <div id="ordersList"></div>
  </main>

  <script src="assets/js/script.js"></script>
  <script>
    function loadOrders(){
      const orders = JSON.parse(localStorage.getItem('snapEats_orders') || '[]').slice().reverse();
      const area = document.querySelector('#ordersList');
      if(orders.length===0) return area.innerHTML = `<div class="alert alert-info">No orders yet.</div>`;
      let html = '<div class="list-group">';
      orders.forEach(o => {
        html += `<div class="list-group-item d-flex justify-content-between align-items-center">
          <div>
            <div class="fw-bold">${o.id} — ${o.name}</div>
            <small class="text-muted">${new Date(o.createdAt).toLocaleString()}</small>
            <div>${o.items.map(i=> `${i.qty} x ${i.name}`).join(', ')}</div>
          </div>
          <div class="text-end">
            <select onchange="changeStatus('${o.id}', this.value)" class="form-select form-select-sm mb-2">
              <option ${o.status === 'Preparing' ? 'selected' : ''}>Preparing</option>
              <option ${o.status === 'Ready' ? 'selected' : ''}>Ready</option>
              <option ${o.status === 'PickedUp' ? 'selected' : ''}>PickedUp</option>
            </select>
            <small class="text-muted">Total LKR ${o.total}</small>
          </div>
        </div>`;
      });
      html += '</div>';
      area.innerHTML = html;
    }
    function changeStatus(orderId, status){
      const orders = JSON.parse(localStorage.getItem('snapEats_orders') || '[]');
      const idx = orders.findIndex(o=>o.id===orderId);
      if(idx===-1) return;
      orders[idx].status = status;
      localStorage.setItem('snapEats_orders', JSON.stringify(orders));
      showToast(`Order ${orderId} status -> ${status}`);
      loadOrders();
    }
    document.addEventListener('DOMContentLoaded', loadOrders);
  </script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
